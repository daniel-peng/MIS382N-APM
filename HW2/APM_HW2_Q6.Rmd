---
title: "APM HW2 Question 6"
author: "Billy Yuan, Lindsay Tober"
date: "October 2, 2016"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This R Markdown document is made interactive using Shiny. Unlike the more traditional workflow of creating static reports, you can now create documents that allow your readers to change the assumptions underlying your analysis and see the results immediately. 

To learn more, see [Interactive Documents](http://rmarkdown.rstudio.com/authoring_shiny.html).



## WorldPhones
```{r worldphones, echo=FALSE}

# Packages
{
  # Uses shiny
  library(shiny)

  # Uses 'WorldPhones' dataset from datasets package
  library(datasets)
}

# Plot
{
  # Dynamic inputs
  # graphdata <- reactive({
  
  #  checkboxformula <- switch(input$year_check,TRUE=year,FALSE=region,region)
  #})
  
  # Render plot
  output$phonePlot <- renderPlot({
  barplot(WorldPhones[,input$region], 
            main=input$region,
            ylab="Number of Telephones (in K)",
            xlab="Year")
  })
}

# Display
{
  # Use a fluid Bootstrap layout
  fluidPage(
    # Title
    titlePanel("Number of telephones by region and year"),
    
    # Use sidebar layout
    sidebarLayout(      
      
      # Define  sidebar inputs
      sidebarPanel(
        
        # Checkboxes
        checkboxInput("region_check", "Region", TRUE),
        checkboxInput("year_check", "Year", FALSE),
        
        # Dropdown options
        selectInput("region", "Region:", 
                    choices=colnames(WorldPhones)),
        selectInput("year", "Year:", 
                    choices=rownames(WorldPhones)),
        
        # Footer
        hr(),
        helpText("Data from AT&T (1961) The World's Telephones.")
      ),
  
      # Create a spot for the barplot
      mainPanel(
        plotOutput("phonePlot")  
      ) 
    ) # end of sidebar layout
  )
}
```

```{r Worldphones2, echo=FALSE}

library(shiny)
library(datasets)

# We tweak the "am" field to have nicer factor labels. Since
# this doesn't rely on any user inputs we can do this once at
# startup and then use the value throughout the lifetime of the
# application
mpgData <- mtcars
mpgData$am <- factor(mpgData$am, labels = c("Automatic", "Manual"))


# Define server logic required to plot various variables against
# mpg
function(input, output) {

  # Compute the formula text in a reactive expression since it is
  # shared by the output$caption and output$mpgPlot functions
  formulaText <- reactive({
    paste("mpg ~", input$variable)
  })

  # Return the formula text for printing as a caption
  output$caption <- renderText({
    formulaText()
  })

  # Generate a plot of the requested variable against mpg and
  # only include outliers if requested
  output$mpgPlot <- renderPlot({
    boxplot(as.formula(formulaText()),
            data = mpgData,
            outline = input$outliers)
  })
}
```



## Inputs and Outputs

You can embed Shiny inputs and outputs in your document. Outputs are automatically updated whenever inputs change.  This demonstrates how a standard R plot can be made interactive by wrapping it in the Shiny `renderPlot` function. The `selectInput` and `sliderInput` functions create the input widgets used to drive the plot.

```{r eruptions, echo=FALSE}
inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),
  
  sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)

renderPlot({
  hist(faithful$eruptions, probability = TRUE, breaks = as.numeric(input$n_breaks),
       xlab = "Duration (minutes)", main = "Geyser eruption duration")
  
  dens <- density(faithful$eruptions, adjust = input$bw_adjust)
  lines(dens, col = "blue")
})
```

## Embedded Application

It's also possible to embed an entire Shiny application within an R Markdown document using the `shinyAppDir` function. This example embeds a Shiny application located in another directory:

```{r tabsets, echo=FALSE}
shinyAppDir(
  system.file("examples/06_tabsets", package = "shiny"),
  options = list(
    width = "100%", height = 550
  )
)
```

Note the use of the `height` parameter to determine how much vertical space the embedded application should occupy.

You can also use the `shinyApp` function to define an application inline rather then in an external directory.

In all of R code chunks above the `echo = FALSE` attribute is used. This is to prevent the R code within the chunk from rendering in the document alongside the Shiny components.



